<div class="container py-4">
  <h2 class="mb-4 text-center fs-3 text-primary fw-semibold">Кандидатури за работа</h2>

  <div class="card shadow-sm border-0 mb-4 rounded-4">
    <div class="card-header bg-white border-bottom-0 rounded-top-4">
      <h5 class="mb-0 text-secondary fw-semibold fs-5">Филтриране</h5>
    </div>
    <div class="card-body">
      <form class="row gy-3 gx-3 align-items-end small">
        <div class="col-md-4">
          <label class="form-label">Статус</label>
          <input type="number" class="form-control form-control-sm" placeholder="0 - Подадена" [(ngModel)]="filters.status" name="status" />
        </div>
        <div class="col-md-4" *ngIf="userRole === 1">
          <label class="form-label">ID на потребителя</label>
          <input type="number" class="form-control form-control-sm" [(ngModel)]="filters.userId" name="userId" />
        </div>
        <div class="col-md-4">
          <label class="form-label">ID на обявата</label>
          <input type="number" class="form-control form-control-sm" [(ngModel)]="filters.jobAdId" name="jobAdId" />
        </div>
        <div class="col-12 text-end mt-2">
          <button type="button" class="btn btn-sm btn-primary px-3 rounded-pill" (click)="applyFilters()">
            <i class="bi bi-search me-1"></i> Приложи филтрите
          </button>
        </div>
      </form>
    </div>
  </div>

  <div *ngIf="jobApplications.length === 0" class="alert alert-warning text-center small">
    <i class="bi bi-exclamation-triangle me-1"></i> Няма намерени кандидатури.
  </div>

  <div class="row g-3" *ngIf="jobApplications.length > 0">
    <div class="col-md-6" *ngFor="let app of jobApplications">
      <div class="card shadow-sm border-0 h-100 rounded-4">
        <div class="card-body small">
          <h6 class="card-title fw-bold text-dark mb-3">Кандидатура #{{ app.id }}</h6>

          <p><strong>Име:</strong> {{ app.user.firstName || '' }} {{ app.user.middleName || '' }} {{ app.user.lastName || '' }}</p>
          <p><strong>Потребител:</strong> {{ app.user.username }} <span class="text-muted">(ID: {{ app.userId }})</span></p>

          <p>
            <strong>Роля:</strong>
            <span class="badge rounded-pill px-2 py-1"
              [ngClass]="app.user.role === 1 ? 'bg-danger-subtle text-danger fw-semibold' : 'bg-info-subtle text-dark fw-semibold'">
              {{ app.user.role === 1 ? 'Администратор' : 'Потребител' }}
            </span>
          </p>

          <p>
            <strong>Обява:</strong> {{ app.jobAd.title }}<br />
            <span class="text-muted">от {{ app.jobAd.companyName }} (ID: {{ app.jobAdId }})</span>
          </p>

          <p>
            <strong>Статус:</strong>
            <span class="badge rounded-pill px-2 py-1"
              [ngClass]="{
                'bg-warning text-dark': app.status === 0,
                'bg-success text-white': app.status === 1,
                'bg-secondary text-white': app.status === 2
              }">
              {{ app.status === 0 ? 'Подадена' : app.status === 1 ? 'Одобрена за интервю' : 'Отказана' }}
            </span>
            <span class="text-muted ms-2">Код: {{ app.status }}</span>
          </p>
          <div *ngIf="userRole === 1" class="mt-3">
            <button class="btn btn-sm btn-outline-primary rounded-pill px-3" (click)="goToReview(app.id)">
              <i class="bi bi-clipboard-check me-1"></i> Разгледай
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <nav class="mt-4" *ngIf="pages.length > 0">
  <ul class="pagination pagination-sm justify-content-center">
    <li class="page-item" [class.disabled]="currentPage === 1">
      <button type="button" class="page-link rounded-pill" (click)="onPageClick($event, currentPage - 1)">
        Предишна
      </button>
    </li>

    <li class="page-item" *ngFor="let page of pages" [class.active]="page === currentPage">
      <button type="button" class="page-link rounded-pill" (click)="onPageClick($event, page)">
        {{ page }}
      </button>
    </li>

    <li class="page-item" [class.disabled]="currentPage === totalPages">
      <button type="button" class="page-link rounded-pill" (click)="onPageClick($event, currentPage + 1)">
        Следваща
      </button>
    </li>
  </ul>
</nav>
</div>